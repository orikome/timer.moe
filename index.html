<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TimerThing</title>

    <!-- Alpine.js and Tailwind CSS via CDN (no build step) -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS with color variables -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Our timer application script -->
    <script src="timer.js"></script>

    <style>
      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body class="app-background min-h-screen p-6">
    <!-- Change from max-w-lg to max-w-4xl to accommodate the wider layout -->
    <div x-data="timerApp()" class="max-w-4xl mx-auto">
      <h1 class="text-3xl font-semibold text-center mb-8 text-slate-800">
        TimerThing
      </h1>

      <!-- Timer Cards - Convert to grid layout -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <template x-for="(timer, index) in timers" :key="timer.id">
          <div
            :class="`p-5 rounded-2xl shadow-lg transition-all relative overflow-hidden timer-card ${getColorClass(timer.color, 'bg')}`"
            x-transition:enter="timer-transition-enter-active"
            x-transition:enter-start="timer-transition-enter-from"
            x-transition:leave="timer-transition-leave-active"
            x-transition:leave-end="timer-transition-leave-to"
          >
            <!-- Progress Bar - only for countdown timers -->
            <template x-if="timer.mode === 'countdown' && timer.isRunning">
              <div
                class="absolute inset-0 transition-transform duration-500"
                :class="getColorClass(timer.color, 'progress')"
                :style="`transform: translateY(${ticker, getProgressPercentage(timer)}%)`"
              ></div>
            </template>

            <!-- Content wrapper with z-index -->
            <div class="relative z-10">
              <!-- Close Button (X in corner) -->
              <button
                @click="removeTimer(index)"
                class="absolute top-1 right-1 w-7 h-7 flex items-center justify-center rounded-full bg-white/30 hover:bg-white/60 text-slate-600 hover:text-slate-900 transition-all hover:scale-110 text-lg"
                aria-label="Remove timer"
              >
                Ã—
              </button>

              <!-- Timer Header - Centered with larger name -->
              <div class="flex flex-col items-center mb-3">
                <input
                  type="text"
                  x-model="timer.name"
                  @change="saveTimers()"
                  class="bg-transparent font-medium text-2xl text-center timer-name-input px-2 py-1 max-w-full"
                  :placeholder="`Timer ${index + 1}`"
                />

                <!-- Color Selector - Centered -->
                <div class="flex space-x-3 mt-3">
                  <template x-for="color in colors" :key="color">
                    <button
                      @click="timer.color = color; saveTimers()"
                      :class="`w-6 h-6 rounded-full hover:scale-125 transition-all color-selector-${color} ${timer.color === color ? 'ring-2 ring-slate-700 ring-offset-2' : ''}`"
                      :aria-label="`Select ${color} color`"
                    ></button>
                  </template>
                </div>
              </div>

              <!-- Timer Display -->
              <div class="text-center py-4">
                <div
                  class="text-5xl font-mono font-semibold timer-display"
                  :class="{'timer-running': timer.isRunning}"
                  x-text="formatTime(timer)"
                ></div>
              </div>

              <!-- Timer Controls -->
              <div
                class="flex flex-wrap items-center justify-between gap-3 mt-3"
              >
                <!-- Mode Toggle -->
                <button
                  @click="toggleMode(timer)"
                  class="timer-button px-3 py-2 rounded-xl text-sm"
                >
                  <span
                    x-text="timer.mode === 'countdown' ? 'Countdown' : 'Stopwatch'"
                  ></span>
                </button>

                <!-- Countdown Duration (only for countdown mode) -->
                <template x-if="timer.mode === 'countdown'">
                  <div class="flex items-center">
                    <input
                      type="number"
                      x-model.number="timer.duration"
                      @change="updateDuration(timer)"
                      class="w-14 duration-input rounded-xl px-2 py-1.5 text-center text-sm"
                      min="1"
                    />
                    <span class="ml-1 text-sm">min</span>
                  </div>
                </template>

                <!-- Main Controls -->
                <div class="flex space-x-2">
                  <button
                    @click="toggleTimer(timer)"
                    class="timer-button px-4 py-2 rounded-xl text-sm font-medium"
                  >
                    <span x-text="timer.isRunning ? 'Pause' : 'Start'"></span>
                  </button>

                  <button
                    @click="resetTimer(timer)"
                    class="timer-button px-4 py-2 rounded-xl text-sm font-medium"
                  >
                    Reset
                  </button>
                </div>
              </div>
            </div>
          </div>
        </template>
      </div>

      <!-- Add Timer Button - Enhanced -->
      <div class="text-center">
        <button
          @click="addTimer()"
          class="add-button px-6 py-3 rounded-xl font-medium text-lg transition-all"
        >
          Add Timer
        </button>
      </div>
    </div>
  </body>
</html>
